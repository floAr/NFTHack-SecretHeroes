(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{QeBL:function(e,t,r){"use strict";r.r(t);var n=r("HaE+"),a=r("o0o1"),s=r.n(a),i=r("qKvR"),c=r("Wbzz"),o=r("q1tI"),u=r("XKqa"),l=r("+ego"),d=r("9eSz"),p=r.n(d),f=r("nNBN"),m=r("EHFx"),b=r("205R"),g=r("L8Ju"),h=r("wPIL");function w(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return v(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return v(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(r=e[Symbol.iterator]()).next.bind(r)}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var y={name:"d21ca",styles:"display:grid;grid-template-columns:0.1fr 8fr 2fr 0.1fr;grid-template-rows:0.2fr 3fr;grid-column-gap:5px;grid-row-gap:5px;place-items:center;height:100%;align-content:stretch;"},x={name:"1fe9xrf",styles:"grid-area:1 / 3 / 2 / 4;width:100%;height:100%;object-fit:contain;"},O={name:"1wvbt8q",styles:"grid-area:1 / 2 / 2 / 3;align-content:center;align-items:center;vertical-align:middle;width:100%;font-weight:bold;padding:0.1vw 2vw 0.1vw 2vw;border-radius:10px;background:rgb(245,245,245);backdrop-filter:blur(10px);box-shadow:-0.25rem -0.25rem 0.5rem rgba(255,255,255,0.07),0.25rem 0.25rem 0.5rem rgba(0,0,0,0.12),-0.75rem -0.75rem 1.75rem rgba(255,255,255,0.07),0.75rem 0.75rem 1.75rem rgba(0,0,0,0.12),inset 8rem 8rem 8rem rgba(0,0,0,0.05),inset -8rem -8rem 8rem rgba(255,255,255,0.05);display:flex;justify-content:space-between"},j={name:"ovwgyn",styles:"margin-left:15px;"},k={name:"ovwgyn",styles:"margin-left:15px;"},S={name:"fhxb3m",styles:"display:flex;flex-direction:row;align-items:center"},C={name:"1jj7er4",styles:"padding:15px"},_={name:"18xffxq",styles:"grid-area:2 / 2 / 3 / 3;height:100%;width:100%;padding:5vh 5vw;border-radius:10px;background:rgb(245,245,245);backdrop-filter:blur(10px);box-shadow:-0.25rem -0.25rem 0.5rem rgba(255,255,255,0.07),0.25rem 0.25rem 0.5rem rgba(0,0,0,0.12),-0.75rem -0.75rem 1.75rem rgba(255,255,255,0.07),0.75rem 0.75rem 1.75rem rgba(0,0,0,0.12),inset 8rem 8rem 8rem rgba(0,0,0,0.05),inset -8rem -8rem 8rem rgba(255,255,255,0.05);"},A={name:"1jc0dbt",styles:"grid-area:2 / 3 / 3 / 4;width:100%;height:100%;align-self:flex-start;padding:5vh 5vw;border-radius:10px;background:rgb(245,245,245);backdrop-filter:blur(10px);box-shadow:-0.25rem -0.25rem 0.5rem rgba(255,255,255,0.07),0.25rem 0.25rem 0.5rem rgba(0,0,0,0.12),-0.75rem -0.75rem 1.75rem rgba(255,255,255,0.07),0.75rem 0.75rem 1.75rem rgba(0,0,0,0.12),inset 8rem 8rem 8rem rgba(0,0,0,0.05),inset -8rem -8rem 8rem rgba(255,255,255,0.05);"},q={name:"8atqhb",styles:"width:100%;"};t.default=function(){var e=Object(c.c)("3473108975"),t="undefined"!=typeof window,r=Object(o.useState)(!1),a=r[0],d=r[1],v=Object(o.useState)(void 0),E=v[0],N=v[1],P=Object(o.useState)(void 0),J=P[0],T=P[1],I=Object(o.useState)(t?localStorage.getItem("viewingKey"):null),M=I[0],B=I[1],D=Object(o.useState)(void 0),R=D[0],K=D[1],W=Object(o.useState)([]),G=W[0],H=W[1],U=Object(o.useState)(void 0),V=U[0],z=U[1];t&&(window.registerUnityInstance=K);var L=function(){var e=Object(n.a)(s.a.mark((function e(t){var r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=function(e){return new Promise((function(t){return setTimeout(t,e)}))};case 1:if(window.keplr||window.getOfflineSigner||window.getEnigmaUtils){e.next=6;break}return e.next=4,r(10);case 4:e.next=1;break;case 6:return e.next=8,window.keplr.experimentalSuggestChain({chainId:t,chainName:"Secret Testnet",rpc:"http://bootstrap.secrettestnet.io:26657",rest:"https://bootstrap.secrettestnet.io",bip44:{coinType:529},coinType:529,stakeCurrency:{coinDenom:"SCRT",coinMinimalDenom:"uscrt",coinDecimals:6},bech32Config:{bech32PrefixAccAddr:"secret",bech32PrefixAccPub:"secretpub",bech32PrefixValAddr:"secretvaloper",bech32PrefixValPub:"secretvaloperpub",bech32PrefixConsAddr:"secretvalcons",bech32PrefixConsPub:"secretvalconspub"},currencies:[{coinDenom:"SCRT",coinMinimalDenom:"uscrt",coinDecimals:6}],feeCurrencies:[{coinDenom:"SCRT",coinMinimalDenom:"uscrt",coinDecimals:6}],gasPriceStep:{low:.1,average:.25,high:.4},features:["secretwasm"]});case 8:return e.next=10,window.keplr.enable(t);case 10:d(!0);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),F=function(){var e=Object(n.a)(s.a.mark((function e(){var r,n,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=window.getOfflineSigner("holodeck-2"),e.next=3,r.getAccounts();case 3:n=e.sent,a=new u.SigningCosmWasmClient("https://bootstrap.secrettestnet.io",n[0].address,r,window.getEnigmaUtils("holodeck-2"),{init:{amount:[{amount:"300000",denom:"uscrt"}],gas:"300000"},exec:{amount:[{amount:"980000",denom:"uscrt"}],gas:"980000"}}),t&&(window.scrtClient=a),T(a);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Q=function(){var e=Object(n.a)(s.a.mark((function e(t,r){var n,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==J?void 0:J.execute(t,r);case 2:return n=e.sent,a=(new TextDecoder).decode(null==n?void 0:n.data),console.log("exec: ",a),e.abrupt("return",JSON.parse(a));case 6:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),X=function(){var e=Object(n.a)(s.a.mark((function e(t){var r,n,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==J?void 0:J.queryContractSmart(f.a.nft.address,f.a.nft.queries.privateMetadata(t,E.address));case 2:return r=e.sent,n=JSON.parse(r.private_metadata.image),a={id:t,name:r.private_metadata.name,weapons:n[0],engineering:n[1],biotech:n[2],psychics:n[3]},e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),$=function(){var e=Object(n.a)(s.a.mark((function e(){var t,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==J?void 0:J.queryContractSmart(f.a.bullpen.address,f.a.bullpen.queries.fightStatus(E.address));case 2:t=e.sent,r={heroes_waiting:t.bullpen.heroes_waiting,your_hero:null},null!==t.bullpen.your_hero&&(r.your_hero={id:t.bullpen.your_hero.name,name:t.bullpen.your_hero.name,weapons:t.bullpen.your_hero.skills[0],engineering:t.bullpen.your_hero.skills[1],biotech:t.bullpen.your_hero.skills[2],psychics:t.bullpen.your_hero.skills[3]},JSON.stringify(r)!==JSON.stringify(V)&&void 0!==R&&(R.SendMessage("WebGlBridge","ReportBattleStatus",JSON.stringify(r)),z(r)));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Y=function(){var e=Object(n.a)(s.a.mark((function e(){var t,r,n,a,i,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],e.next=3,null==J?void 0:J.queryContractSmart(f.a.nft.address,f.a.nft.queries.getAllTokens(window.scrtAccount.address));case 3:r=e.sent,n=r.token_list.tokens,a=w(n);case 6:if((i=a()).done){e.next=15;break}return c=i.value,e.t0=t,e.next=11,X(c);case 11:e.t1=e.sent,e.t0.push.call(e.t0,e.t1);case 13:e.next=6;break;case 15:void 0!==R&&t.length>0&&R.SendMessage("WebGlBridge","ReportTokens",JSON.stringify(t));case 16:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Z=function(){var e=Object(n.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return[],e.next=3,null==J?void 0:J.queryContractSmart(f.a.bullpen.address,f.a.bullpen.queries.fightHistory(E.address));case 3:t=e.sent,console.log(t),JSON.stringify(t)!==JSON.stringify(t.battle_history.history)&&H(t.battle_history.history);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ee=function(){var e=Object(n.a)(s.a.mark((function e(){var t,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==J?void 0:J.getAccount(null==E?void 0:E.address);case 2:if(t=e.sent,null!=M){e.next=10;break}return e.next=6,Q(f.a.bullpen.address,f.a.bullpen.messages.setViewingKey());case 6:return r=e.sent,e.next=9,Q(f.a.nft.address,f.a.nft.messages.setViewingKey());case 9:try{localStorage.setItem("viewingKey",r.viewing_key.key),B(r.viewing_key.key)}catch(n){}case 10:N(t);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),te=function(e){return null==e||0===e.length?f.a.getEntropy():e},re=function(){var e=Object(n.a)(s.a.mark((function e(){var t,r,n,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=te(prompt("Enter the name of your first hero")),r=te(prompt("Enter the name of your second hero")),n=te(prompt("Enter the name of your third hero")),e.next=5,Q(f.a.minter.address,f.a.minter.messages.mint(t,r,n));case 5:if("Success"!==e.sent.status.status){e.next=24;break}return a=[],e.t0=a,e.next=11,X(t);case 11:return e.t1=e.sent,e.t0.push.call(e.t0,e.t1),e.t2=a,e.next=16,X(r);case 16:return e.t3=e.sent,e.t2.push.call(e.t2,e.t3),e.t4=a,e.next=21,X(n);case 21:e.t5=e.sent,e.t4.push.call(e.t4,e.t5),s=a,void 0!==R&&R.SendMessage("WebGlBridge","RegisterMint",JSON.stringify(s));case 24:case"end":return e.stop()}var s}),e)})));return function(){return e.apply(this,arguments)}}();Object(o.useEffect)((function(){L("holodeck-2")}),[]),Object(o.useEffect)((function(){a&&F()}),[a]),Object(o.useEffect)((function(){J&&ee()}),[J]),Object(o.useEffect)((function(){console.log("trying unlock - account: "+E+" & unityInstace: "+R),E&&R&&R.SendMessage("WebGlBridge","Connect")}),[E,R]),Object(m.a)(Object(n.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!E){e.next=7;break}return e.next=3,Y();case 3:return e.next=5,$();case 5:return e.next=7,Z();case 7:case"end":return e.stop()}}),e)}))),15e3);var ne=function(){var e=Object(n.a)(s.a.mark((function e(t){var r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Q(f.a.nft.address,f.a.nft.messages.sendNft(t));case 3:r=e.sent,console.log(r),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0),console.log("error");case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}();return t&&(window.scrtContracts=f.a,window.scrtAccount=E,window.scrtExec=Q,window.scrtPoll=Y,window.scrtPollBattle=$,window.scrtMint=re,window.scrtSentToBattle=ne),Object(i.d)(l.a,null,Object(i.d)("div",{css:y},Object(i.d)(p.a,{css:x,fluid:e.file.childImageSharp.fluid,alt:"Secret Heroes"}),Object(i.d)("div",{css:O},void 0===E?Object(i.d)("h4",{css:j},"Connecting - you need the ",Object(i.d)("a",{href:"https://wallet.keplr.app/"}," Keplr Wallet")," to interact with the game"):Object(i.d)("h4",{css:k},"Connected as ",E.address),Object(i.d)("div",{css:S},Object(i.d)("h4",{css:C},"Currently waiting to fight:"),V&&Object(i.d)(h.a,{report:V}),void 0===V&&Object(i.d)("h4",null,"-"))),Object(i.d)("div",{css:_},Object(i.d)(g.a,null)),Object(i.d)("div",{css:A},Object(i.d)("h4",null,"Battle Results"),0===G.length?"No battles yet":Object(i.d)("ul",null,G.map((function(e){return Object(i.d)("li",{css:q,key:e.battle_number},Object(i.d)(b.a,{report:e})," ")}))))))}}}]);
//# sourceMappingURL=a39c196d-51867a7c0febe8636a0f.js.map